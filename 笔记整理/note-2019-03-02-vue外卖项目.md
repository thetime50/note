# 外卖vue前端项目

## 02 项目开发准备
[link](https://www.bilibili.com/video/av27148092)  
[zxfjd3g/180920_gshop-client](https://github.com/zxfjd3g/180920_gshop-client)  
[W-Qing/Vue-MintShop](https://github.com/W-Qing/Vue-MintShop)  

[vue项目-硅谷外卖 pan.baidu](链接: https://pan.baidu.com/s/1jR5FeeIcFkLygxtGorz8Uw)  
提取码: s6d3

1. 基于 Vue 的最新版本；
2. 项目是关于外卖业务的前后台分离Web App，功能模块包含商家, 商品, 购物车, 用户管理等多个模块； 
3. 后台应用技术架构为: Node + Express + Mongodb + Mongoose；
4. 前台应用技术架构为: vue + vuex + vue-router + webpack + ES6；
5. 采用模块化、组件化、工程化的模式开发；

项目文件结构  
client_blank//脚手架文件  
client_final//客户端最终版本  
client_pages//静态页面  
server_final//服务端  

### 技术选型

- 前台数据交互处理组件化
	- vue  // //Vue技术栈
	- vue-router //单页路由
	- vuex //管理状态
	- mint-ui //ui组件库
	- vue-lazyload //懒加载
	- vue-croller //滑动库
	- better-scroll
	- swiper
	- moment //这个小一点//日期处理
	- date-fns
- 前后台交互
	- mock数据:mockjs
	- 接口测试：postman
	- ajax请求：vue-resource axios
- 模块化
	- ES6
	- bable
- 项目结构化/工程化
	- webpack
	- vuecli
	- eslint //检测语法规范
- css预编译
	- stylus

### 前端路由
- 一级路由
	- --底部导航--
	- 首页
		 - /msite
		 - Msite.vue
	- 搜索
		 - /seach
		 - Seach.vue
	- 订单
		 - /order
		 - Order.vue
	- 个人
		 - /profile
		 - Profile.vue
	- --不显示导航--
	- 登陆
		- /login
		- Login.vue
	- 商家
		- /shop
		- Shop.vue
- 二级路由（商家）
	- 商品
		- /goods
		- ShopGoods.vue
	- 评价
		- /ratings
		- ShopRatings.vue
	- 信息
		- /info
		- ShopInfo.vue

嵌套才作为子路由

### API
前后台交互API
- API(url 方式 数据格式 / 响应格式)
- 接口文档
- 核对接口
- 联调
- 前后台分离
- mock数据//模拟数据

### 项目vue组件
![项目vue组件](img/note-2019-03-02-vue外卖项目/ProjectVueModule.png)

## 03 创建项目运行

```
gshop
	|-- build: webpack配置文件
	|-- config: webpack配置文件
		|-- index.js: 后台端口 静态资源 打开浏览器
	|-- node_modumes 依赖
	|-- sec: 源码
		|-- main.js: 应用入口
	|-- static: 静态资源文件 如全局样式
	|-- .babelrc: babel配置
	|-- .editorconfig: 编辑器编码/格式配置
	|-- .eslintignore: eslint检查忽略
	|-- .eslintrc: eslint检查
	|-- .gitignore: git忽略配置
	|-- index.html: 主页面
	|-- package.json: 应用包配置信息 版本号 依赖 命令
	|-- README.md: 说明文件
```


开发环境运行  
vue init webpack folder //创建项目  
cd colder  
npm install //安装依赖  
npm run dev // mpn start //运行  

生产环境打包运行  
npm run build // 打包项目  
npm install -g serve //安装打包项目  
serve dist //运行  

config/index.js:autoOpenBrowser//自动打开浏览器

## 04 资源准备
1. 标注图(设计稿)：标注界面元素的坐标 大小 元素
2. 切图：PS切图拿素材
3. 图片base64编码：小图片转为字符编码 减少请求次数（打包工具会做）
4. 2x图3x图：适配屏幕尺寸

**iconfont**图标字体
[iconfont](www.iconfont.cn)  
矢量图 改变图标颜色大小不需要PS
```html
<link rel="stylesheet" href=""></link><!--引入-->
```
添加后需要更新url

## 05 项目目录结构
WebStorm

src
	|-- api         //后台交互模块(ajax函数/接口函数)  
	|-- common      //共用资源(or assets fonts/images/stylus)  
	|-- components  //非路由组件  
	|-- filters      //自定义过滤器模块  
	|-- mock        //模拟数据接口  
	|-- pages       //路由组件  
	|-- router      //路由器  
	|-- store       //Vuex相关模块  
	|-- App.vue     //应用根组件  
	|-- main.js     //js入口文件  

## 06 stylus

1. 安装依赖包  
*npm install stylus stylus-loader --save-dev*  
stylus: stylus转译为css包  
stylus-loader: webpack的stylus构建工具

2. 编写样式  
&ltstyle lang="stylus" rel="stylesheet/stylus">&lt/style>  
stylus语法声明

> stylus说明：  
	1. [stylus-en](http://stylus-lang.com/) [stylus-zh](https://stylus.bootcss.com/)  
	2. 代码由缩进控制，用table不要用空格，省略{ ; 可选 :  
	3. 父级引用 &  
	4. 变量 $  
	5. 混合  
	6. 导入  

> [stylus预处理入门(一)](https://www.jianshu.com/p/5838497ec56e)

common/stylus/mixins.styl
```stylus
$green = #02a774;
$yellow = #F5A100;
$bc = #e4e4e4;

// 一像素下边框
bottom-border-1px($color)
  position relative
  border none
  &:after
    content ''
    position absolute
    left 0
    bottom 0
    width 100%
    height 1px
    background-color $color
    transform scaleY(0.5)

// 一像素上边框
top-border-1px($color)
  position relative
  &::before
    content ''
    position absolute
    z-index 200
    left 0
    top 0
    width 100%
    height 1px
    background-color $color

//根据像素比缩放1px像素边框
@media only screen and (-webkit-device-pixel-ratio: 2 )
  .border-1px
    &::before
      transform scaleY(.5)

@media only screen and (-webkit-device-pixel-ratio: 3 )
  .border-1px
    &::before
      transform scaleY(.333333)

//根据像素比来使用 2x图 3x图
bg-image($url)
  background-image: url($url + "@2x.png")
  @media (-webkit-min-device-pixel-ratio: 3),(min-device-pixel-ratio: 3)
    background-image: url($url + "@3x.png")

//清除浮动
clearFix()
  *zoom 1
  &::after
    content ''
    display block
    clear both
	 
```

## 07 组件化编码

### 添加模板
file->setings...->editer->file and code tamplates->files->vue

```html
<template>
	<div>
		
	</div>
</template>

<script>
	export default {}
</script>

<style lang="stylus" rel="stylesheet/stylus">
	
</style>
```

### vue组件结构

```
src
|-- components------------	非路由组件文件夹
	|-- FooterGuide---------底部组件文件夹
		|-- FooterGuide.vue--底部组件 vue
|-- pages------------------路由组件文件夹
	|-- Msite---------------首页组件文件夹(home)
		|-- Msite.vue--------首页组件 vue
	|-- Search--------------搜索组件文件夹
		|-- Search.vue-------搜索组件 vue
	|-- Order---------------订单组件文件夹
		|-- Order.vue--------订单组件 vue
	|-- Profile-------------个人组件文件夹(personal)
		|-- Profile.vue------个人组件 vue
|-- App.vue----------------应用根组件 vue
|-- main.js----------------应用入口 js
```

组件目录 vue组件文件 组件内名字(template->div)


```javascript
//main.js
import Vue from 'vue'
import App from './App.vue'

new Vue({
	el: '#app'
	render: h => h(App)
})
```

### 引入reset样式

1. static/css/reset.css
```css
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
```

index.html中引入
```html
<!--index.html-->

<title>...</title>
<!-- + -->
<link rel='stylesheet' href='/static/css/reset.css'>
<link rel='stylesheet' ... >
```

### 移动端

1. viewport

2. 点击0.3s问题

```html
<!--index.html-->
<head>

<meta charset="utf-8">

<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
<!-- + -->
<meta name="viewport"
   content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">

.<title>gshop</title>

<link rel="stylesheet" href="/static/css/reset.css">

<link rel="stylesheet" href="http://at. alicdn.com/t/font_518606_6676bmcalnrhehfr. css">

<!-- + -->
<script src="https://as.alipayobjects.com/g/component/fastclick/1.0.6/fastclick.js"></script>

<!-- + -->
<script>
if ( ' addEventListener' in document) {
	document.addEventListener( 'DOMContentLoaded' , function() {
		FastClick.attach( document.body ) ;
}, false);
if( !window.Promise) {
document.writeln('<script src="https://as.alipayobjects.com/g/component/es6-promise/3.2.2/es6-promise.min.js')//这个链接不确定
}
</head>
```

## 08 引入vue-router

1. 下载vue-router

```
npm install vue-router --save
```

2. 编码
	- router/index.js
	- 入口文件main.js
	- App.vue里使用router-view

**router/index.js**
```javascript
 /*
   路由模块 
 */
 import Vue from 'vue'
 import VueRouter from 'vue-router'
 // 引入路由组件文件夹下的组件
 import Msite from '../pages/Msite/Msite.vue'
 import Search from '../pages/Search/Search.vue'
 import Order from '../pages/Order/Order.vue'
 import Profile from '../pages/Profile/Profile.vue'
 // 全局注册Vue-router组件
 Vue.use(VueRouter)
 
 // 配置路由表并导出
 export default new VueRouter({
   //去掉地址中的哈希#
   mode: 'history',
   routes: [{
       path: '/', //默认页面
       redirect: '/msite'
     },
     {
       path: '/msite',
       component: Msite,
     },
     {
       path: '/search',
       component: Search,
     },
     {
       path: '/order',
       component: Order,
     },
     {
       path: '/profile',
       component: Profile,
     }
   ]
 })
```

**编写应用的入口文件main.js**
```javascript
//main.js
import Vue from 'vue'
import App from './App.vue'
//+
import touter from './router'

new Vue({
	el: '#app'
	render: h => h(app)，
	//+
	router//增加rout的3个组件和2个属性
})
```

**在App.vue里使用router-view**
```html
<!-- App.vue -->

<template>
  <!-- 修改应用组件的模板 -->
  <div id="app">
    <!-- 设置路由组件的视图位置 -->
    <router-view></router-view>
    <!-- 并放置非路由组件 -->
	<FooterGuide></FooterGuide>
	
	<!-- 或者作用闭合标签<FooterGuide/> -->
  </div>
</template>

<script>
import FooterGuide from './components/FooterGuide/FooterGuide.vue'
// 引入底部组件并注册
export default {
  components: {
    FooterGuide
  }
}
</script>

<style lang="stylus" rel="stylesheet/stylus">
// 整个应用组件的样式
  #app
    width 100%
    height 100%
    background #f5f5f5
</style>
```

## 09 FooterGuide组件

1. 实现导航组件页面切换
2. 用动态class和$route.path实现tab样式切换
3. 用阿里图标库显示导航图标

### 抽取静态页面

抽取静态页面的样式和HTML到vue文件中

**根组件**
抽取样式 stylus/index.styl -> #app  
与 App.vue &lttemplate> 的 div id 对应  
在 &ltstyle> 里添加 .app 和抽取的样式

**FooterGuide**
抽取index.html -> &ltfooter_guide>  
到 FooterGuide.vue &lttemplate> 中  
抽取样式 stylus/index.styl -> .footer_guide  
到 FooterGuide.vue &lt&ltstyle> 中  
添加 common/styles/index.styl 文件引用引入变量

```html
<!-- template的图标强制绑定动态class
 -->
<!-- 对象语法 -->
<div class="guide_item" :class="{on: isCurrent('/msite')}">
<div class="guide_item" :class="{on: '/msite'===$route.path}">

<!--
	:class=
	{} 对象
	on:类名
	后边更布尔值

	已知class名称 决定是否添加
-->


<!-- 绑定onClick事件 -->
<div class="guide_item" :class="{on: isCurrent('/msite')} " @click="goto('/msite')">

<script>
ecport default {
	methods: {
		goTo(path) {
			this.$router.replace(path)
		}
	}
}
</script>
```

## 10 各导航路由组件(静态)
### Msite组件
Msite下新建images文件夹
考入图片资源/nav(分类导航) /shop(商家) /stars(星星)

复制代码 样式(对应class 引入index.styl

### Search组件
Slot语法抽取样式

## 11 HeaderTop组件
头部区分不同页面用Slot
头部这样标题的文字用Pnops
文件结构同FooterGuide

HeaderTop.vue
```html
<template>
  <header class="header">
    <!-- 插槽是父组件与子组件的通讯方式，子组件中的slot可以显示父组件传递给子组件的内容 -->
    <slot name="left"></slot> <!-- 插槽 -->
    <span class="header_title">
	 	<!-- 内容接收一个属性 -->
      <span class="header_title_text ellipsis">{{title}}</span>
    </span>
    <slot name="right"></slot> <!-- 插槽 -->
  </header>
</template>
<script>
  export default {
    // 外部组件传递给此组件的属性
    props: {
      title: String
    }
  }
</script>
```

在Msite等组件内引入HeaderTop
```html
<!-- 使用 title 来给头部组件传递数据 -->
<HeaderTop title="芝罘区鲁东大学北区(青年南路)">
  <!-- 要使用slot="left"指定插入的插槽位置 -->
  <span class="header_search" slot="left">
  <!-- 使用插槽 -->
    <i class="iconfont icon-sousuo"></i>
  </span>
  <span class="header_login" slot="right">
  <!-- 使用插槽 -->
    <span class="header_login_text">
          登录|注册
    </span>
  </span>
</HeaderTop>

<script>
//Msite、Order、Search、Profile中都要引入注册才能使用
import HeaderTop from '../../components/HeaderTop/HeaderTop.vue'
export default {
  components: {
    HeaderTop
  }
}
</script>
```

---
### props
效果类似函数参数  

组件:comp.vue
```html
<template>
	<span class="header_title_text ellipsis">{{para}}</span><!-- 使用props参数 -->
<template>

<script>
//Msite、Order、Search、Profile中都要引入注册才能使用
import HeaderTop from '../../components/HeaderTop/HeaderTop.vue'
  export default {
    props: {//相当于定义参数
      para: String
    }
  }
</script>
```

引用:
```html
<template>
	<!-- 组件映射为标签 参数映射为属性 -->
	<comp para=“xxxxxx” />
</template>
<script>
//引入插件
import conp from './conp.vue'
export default {
  components: {
    conp//注册插件 能够作为标签引用
  }
}
</script>
```

### slot
类似引用父对象声明的父级变量

组件：
```html
<template>
	<!-- slot对应父级的属性 name对应slot属性的值 -->
	<slot name="left"></slot> <!-- 插槽 -->
</template>
```

引用：
```html
<template>
  <!-- solt 对应组件的slot标签 "right"对应name属性 -->
  <!-- 组件里的插槽占位 标签和内容都会被父级替换掉 -->
  <conp>
	<span slot="right">
		<span>
				登录|注册
		</span>
	</span>
  </conp>
</template>

<script>
//引入插件
import conp from './conp.vue'
export default {
  components: {
    conp//注册插件 能够作为标签引用
  }
}
</script>
```

引用时
1. import插件 components作为标签(dom元素)
2. 在template里用 comp标签 用组件的template替换
3. 标签属性对应props
4. 标签内容添加slot属性 对应slot 替换掉组件内的slot

组件内
1. 用props定义传递数据name 类型
2. 在template里使用 {{name}} 引用数据
3. 用slot标签占位 name属性标记

组件component作为最终实现效果给父级引用
父级用props给组件传递数据
父级用slot给组件传递DOM
