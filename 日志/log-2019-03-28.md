# 前端面试题整理

[一年前端面试打怪升级之路（一）](https://www.jianshu.com/p/61aefada8cac)  
[一年前端面试打怪升级之路（二）](https://www.jianshu.com/p/7024a48c65d9)  
[一年前端面试打怪升级之路（三）](https://www.jianshu.com/p/2831cb94fda6)  
[一年前端面试打怪升级之路（四）](https://www.jianshu.com/p/fbd24713ba4a)

## HTML

## CSS

## JS

## 浏览器
### 同源策略和跨域
[同源策略与跨域](https://www.jianshu.com/p/2b9db9d0a63d) (document.domain window.name postMessage 片段识别符 AJAX)  
[浏览器同源政策及其规避方法](http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html) (document.domain 片段识别符 window.name window.postMessage+LocalStorage AJAX+WebSocket)  
[跨域的几种方式 ](http://www.cnblogs.com/zhuzhenwei918/p/6759459.htm) (document.domain location.hash window.name postMessage CORS)  


同源策略：
- 端口相同
- 域名相同
- 协议相同

跨域的受限行为：
1. Cookie、LocalStorage 和 IndexDB 无法读取。
2. Dom无法获取
3. Ajax请求(jsonp只能get)

解决方法：
**1. document.domain**
1. 在同窗口下 不同域名二级域名的iframe
2. 设置document.domain为一级域名
3. 可共享DOM和Cookit

```
document.getElementById("myIFrame").contentWindow  
document.getElementById("myIFrame").contentDocument  
window.parent.document.body
```

服务器也可以在设置Cookie时，指定名为一级域名

**2. window.name**
1. 同窗口页面
2. 通过window.name共享数据
3. 2M

[JS跨域--window.name](https://www.jianshu.com/p/43ff69d076e3)
```javascript
    var boo = false;
    var iframe = document.createElement('iframe');
    var loadData = function() {
        if (boo) {
            var data = iframe.contentWindow.name;    //获取window.name
            console.log(data); 
            //销毁数据   
            iframe.contentWindow.document.write('');
            iframe.contentWindow.close();
            document.body.removeChild(iframe);
        } else {
            boo = true;
            iframe.contentWindow.location = "b.html";    // 设置的代理文件,iframe重新载入
        }  
    };
    iframe.src = 'https://xxx.github.io/xxx';
    if (iframe.attachEvent) {
        iframe.attachEvent('onload', loadData);
    } else {
        iframe.onload  = loadData;
    }
    document.body.appendChild(iframe);
```

**3. window.postMessage**
1. H5 跨源通讯方法 window.postMessage  
2. 跨源 跨窗口

[html5 postMessage解决跨域、跨窗口消息传递](https://www.cnblogs.com/dolphinX/p/3464056.html)

window.postMessage(data,origin)
- origin: 同域使用相对路径'/xxx' 跨域使用'协议+主机+端口号' 留空为同域(不安全) '*'为广播

window.addEventListener('message', function(e) {  
  console.log(e.data);  
},false)
- event: 绑定事件，不能以on前缀
- function: 回调
- useCapture：Capture/Bubbing

- e.data：message
- e.source：发送消息的窗口对象
- e.origin：发送消息窗口的源（协议+主机+端口号）

**4. 片段标识符**  
1. 同窗口下
2. 修改URL#后的片段识别符
```javascript
//父窗口
var src = originURL + '#' + data;
document.getElementById('myIFrame').src = src
//或者子窗口  
parent.location.href= target + "#" + hash

//接收
window.onhashchange = checkMessage;
function checkMessage() {
  var message = window.location.hash;
  // ...
}
```

**-- 跨源服务器请求 --**  
Flash 服务器代理 JSONP CORS  

*（直接用XMLHttpRequest()无法跨域）*

**5. AJAX-JSONP**  
1. 通过script标签引入外源脚本
2. 用GET请求
(为了保持刷新增加请求参数？？)

**6. AJAX-CORS**  
[跨域资源共享 CORS 详解](http://www.ruanyifeng.com/blog/2016/04/cors.html)  
（Cross-origin resource sharing）  

**简单请求**
1. 方法为： HEAD GET  POST
2. 头信息在以下范围内：  
 i. Accept  
 ii. Accept-Language  
 iii. Content-Language  
 iv. Last-Event-ID  
 v. Content-Type 为1. application/x-www-form-urlencoded、2. multipart/form-data、3. text/plain


使用XMLHttpRequest向服务器发请求(浏览器加Origin字段)
服务器匹配Origin许可范围  
 返回Access-Control-Allow-Origin字段表示通过  
 XMLHttpRequest onerror失败(状态可能为200)

**非简单请求**  
浏览器会先发送一次'预检请求'，然后再发送XMLHttpRequest